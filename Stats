Refractored from BWC to use ViewModel
